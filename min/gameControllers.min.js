var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);var gameControllers=angular.module("angularApp.controllers");gameControllers.controller("GameCtrl",["$scope","$http","$route","$routeParams","$modal","$window",function(a,b,c,d,e,f){"use strict";a.gameName=d.name||"classic",a.confi={},a.game=null,a.confi.splitScreen="classicSplitScreen"===a.gameName,a.load=function(){b.get("games/"+a.gameName+".json",{cache:!1}).success(function(b){a.useGameConfig(b)}).error(function(a){console.log(a)})},a.load(),a.pause={toggle:function(){a.pause.active=a.game.TogglePause()},active:!1},a.$on("$routeChangeStart",function(){a.game&&(a.game.Stop(),a.game=null)}),a.reset=function(){a.game.Stop(),a.game=new Game(a.game.config,a.game.grid,a.endCallBack),a.game.Start()},angular.element(f).bind("blur",function(){return function(){a.game&&(a.pause.active=!0,a.game.TogglePause(!0),a.$apply())}}()),a.useGameConfig=function(c){CONFIG=GetConfig(c.config),""==c.grid?(a.game=new Game(c,"",a.endCallBack),a.game.Start()):b.get("grids/"+c.grid+".json",{cache:!1}).success(function(b){a.game=new Game(c,b,a.endCallBack),a.game.Start()}).error(function(a){console.log(a)})},a.endCallBack=function(b){b.stats.SetTime(b.tics),b.stats.SetSwaps(b.tetris[0].swapCount);var c=UserStats.GetUserStats();c.AddGame(b.stats,a.gameName);var d=new AchievementsState;d.check(b.stats,c,a.gameName),a.open(b.stateChecker.lastSuccessCheck,b.stats)},a.open=function(b,d){var f=e.open({animation:!0,templateUrl:"templates/modal.html",controller:"ModalInstanceCtrl",size:300,resolve:{won:function(){return b},gameName:function(){return a.gameName},statistics:function(){return d}}});f.result.then(function(){b&&a.game.config.next?(a.gameName=a.game.config.next,c.updateParams({name:a.gameName}),a.load()):a.reset()},function(){})}}]),gameControllers.controller("ModalInstanceCtrl",["$scope","$modalInstance","won","gameName","statistics",function(a,b,c,d,e){a.won=c,a.published=!1,a.publish=function(){"use strict";if(!a.published){a.published=!0;var b=UserStorage.GetStorage(),c=b.Get("UserName")||"";if(c=prompt("Who are you ?",c)){b.Set("UserName",c);var e=stringToHex(des("wireshar","yop"+stats.score,1,0));$.get("http://sylvain.luthana.be/api.php?add&name="+c+"&value="+e+"&map="+d)}else a.published=!1}},a.nextGame=function(){b.close()},a.stop=function(){b.dismiss("cancel")},a.stats=function(){"use strict";function a(a,b,c){return void 0===c&&(c=Math.floor),c(a/b)}var b=UserStats.GetUserStats(),c=b.GetBestGameStats(d),f=b.GetTotalGameStats(d),g=[];return g.push({name:"Score",value:e.score,best:c.score,sum:f.score,mean:a(f.score,f.gameCount)}),g.push({name:"Time",value:TimeFromTics(e.time),best:TimeFromTics(c.time),sum:TimeFromTics(f.time),mean:a(f.time,f.gameCount,TimeFromTics)}),g.push({name:"Blocks",value:e.blockDestroyed,best:c.blockDestroyed,sum:f.blockDestroyed,mean:a(f.blockDestroyed,f.gameCount)}),g.push({name:"Swaps",value:e.swapCount,best:c.swapCount,sum:f.swapCount,mean:a(f.swapCount,f.gameCount)}),g.push({name:"Efficiency",value:(e.score/e.swapCount).toFixed(2),best:"/",sum:"/",mean:(f.score/f.swapCount).toFixed(2)}),g}()}]);