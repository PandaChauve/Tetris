GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()},GridEvaluator=function(a){"use strict";this.series=[],this.stats=a},GridEvaluator.prototype.EvaluateColumn=function(a,b){"use strict";for(var c=0,d=null,e=-1,f=CONFIG.hiddenRowCount;f<a[b].length;f+=1)a[b][f].state!==Block.EState.Blocked?(c=0,d=null):a[b][f].type!==d?(d=a[b][f].type,c=1):(c+=1,3===c?(a[b][f].SetState(Block.EState.Disappearing),a[b][f-1].SetState(Block.EState.Disappearing),a[b][f-2].SetState(Block.EState.Disappearing),this.series.push([]),e=this.series.length-1,this.series[e].push(a[b][f].id),this.series[e].push(a[b][f-1].id),this.series[e].push(a[b][f-2].id)):c>3&&(a[b][f].SetState(Block.EState.Disappearing),this.series[e].push(a[b][f].id)))},GridEvaluator.prototype.EvaluateVertical=function(a){"use strict";for(var b=0;b<CONFIG.columnCount;b+=1)this.EvaluateColumn(a,b)},GridEvaluator.prototype.FindBlockIndex=function(a,b,c){"use strict";var d;for(d in a[b])if(a[b].hasOwnProperty(d)&&a[b][d].verticalPosition===CONFIG.pixelPerBox*c)return parseInt(d);return-1},GridEvaluator.prototype.EvaluateLine=function(a,b){"use strict";var c,d,e,f=-1,g=-1,h=-1;e=0,d=null;var i=-1;for(c=0;c<CONFIG.columnCount;c+=1)if(h=g,g=f,f=this.FindBlockIndex(a,c,b),-1!==f){var j=a[c][f];j.state===Block.EState.Blocked||j.state===Block.EState.Disappearing&&0===j.animationState?(j.type!==d&&(d=a[c][f].type,e=0),e+=1,3===e?(a[c][f].SetState(Block.EState.Disappearing),a[c-1][g].SetState(Block.EState.Disappearing),a[c-2][h].SetState(Block.EState.Disappearing),this.series.push([]),i=this.series.length-1,this.series[i].push(a[c][f].id),this.series[i].push(a[c-1][g].id),this.series[i].push(a[c-2][h].id)):e>3&&(a[c][f].SetState(Block.EState.Disappearing),this.series[i].push(a[c][f].id))):e=0}else e=0},GridEvaluator.prototype.EvaluateHorizontal=function(a){"use strict";for(var b=CONFIG.hiddenRowCount;b<CONFIG.displayedRowCount+CONFIG.hiddenRowCount;b+=1)this.EvaluateLine(a,b)},GridEvaluator.prototype.GetScore=function(){"use strict";for(var a=this.series.length,b=0,c=0;a>c;c+=1)b+=(this.series[c].length-2)*a;return this.stats.AddLines(this.series,b),b},GridEvaluator.prototype.GetSerie=function(a,b){"use strict";for(var c=b-1;c>=0;c-=1)for(var d=0;d<this.series[c].length;d+=1)if(this.series[c][d]===a)return c;return-1},GridEvaluator.prototype.MergeSeries=function(){"use strict";for(var a=this.series.length-1;a>=0;a-=1)for(var b=0;b<this.series[a].length;b+=1){var c=this.GetSerie(this.series[a][b],a);if(-1!==c){this.series[c]=this.series[c].concat(this.series[a]),this.series.splice(a,1);break}}},GridEvaluator.prototype.Evaluate=function(a){"use strict";return this.EvaluateVertical(a),this.EvaluateHorizontal(a),this.MergeSeries(),this.GetScore()};